<div class="slideover" role="dialog" aria-modal="true" aria-labelledby="svc-title">
  <header class="slideover-header">
    <div class="row" style="justify-content:space-between;align-items:center">
      <div>
        <h2 id="svc-title" class="title" style="font-size:1.25rem;margin:0">{{ service.name }}</h2>
        <p class="help">{{ service.type }} • {{ service.duration_minutes }}min • {{ service.timezone }}</p>
      </div>
      <button class="btn" data-close-slideover aria-label="Fechar">✕</button>
    </div>
  </header>
  <div class="slideover-body">
    {% if service_gallery %}
      <section aria-label="Imagens do serviço" style="margin-bottom:var(--space-4)">
        <h3 class="title" style="font-size:1rem;margin:0 0 8px">Galeria</h3>
        <div class="svc-carousel" style="display:flex;gap:12px;overflow-x:auto;padding-bottom:4px">
          {% for g in service_gallery %}
            <figure data-gallery-item="{{ g.id }}" style="flex:0 0 auto;width:180px;margin:0">
              {% if g.thumb_w256 %}
                <img src="{% url 'media:image_public' path=g.thumb_w256.name %}"
                     alt="{{ g.caption|default:'Imagem do serviço' }}"
                     loading="lazy"
                     style="width:100%;height:120px;object-fit:cover;border-radius:10px" />
              {% else %}
                <div class="box" style="height:120px;display:flex;align-items:center;justify-content:center;border-radius:10px;background:var(--bg-elev)">Sem miniatura</div>
              {% endif %}
              {% if g.caption %}
                <figcaption class="muted" style="font-size:0.75rem;margin-top:4px">{{ g.caption }}</figcaption>
              {% endif %}
            </figure>
          {% endfor %}
        </div>
      </section>
    {% endif %}
    <form id="booking-form"
          hx-post="{% url 'public_validate_booking' card.nickname service.id %}"
          hx-trigger="change from:#booking-form, keyup changed delay:1000ms"
          hx-target="#dlg-footer" hx-swap="outerHTML"
          class="grid" style="grid-template-columns:1fr 1fr;gap:12px">
      {% csrf_token %}
      <input type="hidden" name="service" value="{{ service.id }}" />
      <label class="field" style="grid-column:1/-1"><span>Nome</span>
        <input class="input" name="name" required />
      </label>
      <label class="field" style="grid-column:1/-1"><span>E-mail (opcional)</span>
        <input class="input" type="email" name="email" />
      </label>
      <fieldset class="box" style="grid-column:1/-1">
        <label class="field"><span>Telefone (BR)</span>
          <input class="input" name="phone" id="phone" inputmode="tel" placeholder="+55 (11) 9XXXX-XXXX" data-phone-mask required />
        </label>
        <div id="verify-block"
             hx-post="{% url 'public_send_code' card.nickname service.id %}"
             hx-trigger="click from:#send-sms"
             hx-include="#booking-form"
             hx-target="#verify-block" hx-swap="outerHTML">
          <button type="button" id="send-sms" class="btn">Enviar código</button>
        </div>
      </fieldset>
      <label class="field" style="grid-column:1/-1"><span>Data</span>
        <input class="input" type="date" name="date"
               hx-get="{% url 'public_slots' card.nickname %}?service={{ service.id }}"
               hx-target="#slots" hx-swap="innerHTML" />
      </label>
      <div id="slots" class="grid" style="grid-column:1/-1;grid-template-columns:1fr;gap:8px"></div>
    </form>
  </div>
  <div id="dlg-footer" class="slideover-footer">
    {% include 'public/_footer.html' with form_valid=False nickname=card.nickname service_id=service.id %}
  </div>
</div>
