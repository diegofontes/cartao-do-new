<div class="modal-backdrop" id="backdrop" aria-hidden="true"></div>
<div class="modal" id="modal" role="dialog" aria-modal="true" aria-labelledby="modal-title" tabindex="-1">
  <header class="row" style="justify-content:space-between;padding:16px;border-bottom:1px solid var(--border)">
    <h3 id="modal-title">Título do Modal</h3>
    <button class="btn ghost" onclick="window.closeModal()" aria-label="Fechar">
      <svg aria-hidden="true" width="18" height="18"><use href="./icons.svg#icon-trash"></use></svg>
    </button>
  </header>
  <div style="padding:16px">
    Conteúdo do modal
  </div>
</div>
<script>
  (function(){
    const m = document.getElementById('modal');
    const b = document.getElementById('backdrop');
    let lastFocus;
    function trap(e){
      if(!m.classList.contains('open')) return;
      const focusables = m.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
      const first = focusables[0], last = focusables[focusables.length-1];
      if(e.key === 'Tab'){
        if(e.shiftKey && document.activeElement === first){ e.preventDefault(); last.focus(); }
        else if(!e.shiftKey && document.activeElement === last){ e.preventDefault(); first.focus(); }
      } else if(e.key === 'Escape'){ window.closeModal(); }
    }
    window.openModal = function(){ lastFocus = document.activeElement; m.classList.add('open'); b.classList.add('open'); m.focus(); };
    window.closeModal = function(){ m.classList.remove('open'); b.classList.remove('open'); lastFocus && lastFocus.focus(); };
    window.addEventListener('keydown', trap);
  })();
</script>

